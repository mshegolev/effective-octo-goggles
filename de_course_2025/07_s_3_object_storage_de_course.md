# Data Engineering ‚Äî –†–∞–∑–¥–µ–ª 7. S3 –∏ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

**–ê–≤—Ç–æ—Ä:** –©–µ–≥–æ–ª–µ–≤ –ú–∏—Ö–∞–∏–ª  
**–ö—É—Ä—Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, 2025**

---

## üìò –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ß—Ç–æ —Ç–∞–∫–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ](#—á—Ç–æ-—Ç–∞–∫–æ–µ-–æ–±—ä–µ–∫—Ç–Ω–æ–µ-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
2. [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Amazon S3](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏-amazon-s3)
3. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Python —á–µ—Ä–µ–∑ boto3](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-python-—á–µ—Ä–µ–∑-boto3)
4. [–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö DWH –≤ S3](#–º–∏–Ω–∏–ø—Ä–æ–µ–∫—Ç-–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ-–¥–∞–Ω–Ω—ã—Ö-dwh-–≤-s3)
5. [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏](#–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–≤–æ–ø—Ä–æ—Å—ã-–∏-gpt–ø–æ–¥—Å–∫–∞–∑–∫–∏)

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

üìò –ú–∞—Ç–µ—Ä–∏–∞–ª—ã: *S3 ‚Äî Google Docs*  

### üß† –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è
–û–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Object Storage) ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –≤–∏–¥–µ **–æ–±—ä–µ–∫—Ç–æ–≤** (object), –∞ –Ω–µ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –±–ª–æ–∫–æ–≤.

–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
- **–¥–∞–Ω–Ω—ã–µ** (—Ñ–∞–π–ª –ª—é–±–æ–≥–æ —Ç–∏–ø–∞),
- **–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** (–æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞),
- **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á** (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä).

üí° *–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:* –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç–∞–º –∏–¥—ë—Ç –ø–æ API, –∞ –Ω–µ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

### üí° –ü—Ä–∏–º–µ—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤
- Amazon S3  
- MinIO  
- Google Cloud Storage  
- Azure Blob Storage

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –û–±—ä—è—Å–Ω–∏, —á–µ–º –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ñ–∞–π–ª–æ–≤–æ–≥–æ.  
> –ü—Ä–∏–¥—É–º–∞–π, –≥–¥–µ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ DWH.

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Amazon S3

### üß† –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è
- **Bucket** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤.  
- **Object Key** ‚Äî –ø—É—Ç—å –∫ –æ–±—ä–µ–∫—Ç—É –≤–Ω—É—Ç—Ä–∏ –±–∞–∫–µ—Ç–∞.  
- **Region** ‚Äî –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.  
- **Versioning** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –æ–±—ä–µ–∫—Ç–∞.  
- **Lifecycle Policy** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ/–∞—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.  
- **Storage Classes:** Standard, Infrequent Access, Glacier (–∞—Ä—Ö–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ).

### üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ AWS CLI

```bash
# –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç
aws s3 mb s3://my-data-bucket

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
aws s3 cp local_file.csv s3://my-data-bucket/data/local_file.csv

# –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
aws s3 ls s3://my-data-bucket/data/

# –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
aws s3 cp s3://my-data-bucket/data/local_file.csv ./
```

üí° *–°–æ–≤–µ—Ç:* –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π IAM-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –û–±—ä—è—Å–Ω–∏, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç versioning –≤ S3.  
> –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å lifecycle-–ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π?

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Python —á–µ—Ä–µ–∑ boto3

### üß† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```bash
pip install boto3
```

### üíª –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞

```python
import boto3

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
s3 = boto3.client(
    's3',
    aws_access_key_id='YOUR_ACCESS_KEY',
    aws_secret_access_key='YOUR_SECRET_KEY',
    region_name='eu-central-1'
)

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
s3.upload_file('data/sales.csv', 'my-data-bucket', 'raw/sales.csv')

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
s3.download_file('my-data-bucket', 'raw/sales.csv', 'data/sales_copy.csv')

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –±–∞–∫–µ—Ç–µ
response = s3.list_objects_v2(Bucket='my-data-bucket', Prefix='raw/')
for obj in response.get('Contents', []):
    print(obj['Key'])
```

üí° *–°–æ–≤–µ—Ç:* –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π `upload_fileobj()` —Å –ø–æ—Ç–æ–∫–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π.

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é Python –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö CSV –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ –≤ S3.  
> –û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `client` –∏ `resource` –≤ boto3.

---

## –ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö DWH –≤ S3

### üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ DWH (–Ω–∞–ø—Ä–∏–º–µ—Ä, ClickHouse –∏–ª–∏ PostgreSQL) –≤ S3.

### üìã –≠—Ç–∞–ø—ã –ø—Ä–æ–µ–∫—Ç–∞
1. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã DWH –≤ CSV/Parquet.  
2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ S3 –≤ –ø–∞–ø–∫—É `/archive/YYYY/MM/DD/`.  
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ lifecycle-–ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ Glacier.

### üíª –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```python
import boto3
from datetime import date

s3 = boto3.client('s3')

file_path = f"/tmp/export_{date.today()}.csv"
s3_path = f"archive/{date.today().year}/{date.today().month}/{date.today()}.csv"

s3.upload_file(file_path, 'my-data-bucket', s3_path)
print(f"–§–∞–π–ª {file_path} —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ {s3_path}")
```

üí° *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:* —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∏–∑ Airflow DAG –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –î–æ–±–∞–≤—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.  
> –ü–æ–ø—Ä–æ—Å–∏ GPT –æ–±—ä—è—Å–Ω–∏—Ç—å, –∫–∞–∫ —Å–≤—è–∑–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å ClickHouse.

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏

1. –ß—Ç–æ —Ç–∞–∫–æ–µ –±–∞–∫–µ—Ç –≤ S3?  
2. –ß–µ–º –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ñ–∞–π–ª–æ–≤–æ–≥–æ?  
3. –ß—Ç–æ —Ç–∞–∫–æ–µ versioning –∏ lifecycle policy?  
4. –ö–∞–∫–∏–µ –µ—Å—Ç—å –∫–ª–∞—Å—Å—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ S3?  
5. –ö–∞–∫ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –∏–∑ Python —Å –ø–æ–º–æ—â—å—é boto3?  
6. –ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ DWH –≤ S3?

üí° *–°–æ–≤–µ—Ç:* –µ—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω ‚Äî —Å–ø—Ä–æ—Å–∏ GPT:  
> ¬´–û–±—ä—è—Å–Ω–∏, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ S3¬ª  
> ¬´–ü–æ–º–æ–≥–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ S3¬ª

---

‚úÖ **–ò—Ç–æ–≥ —Ä–∞–∑–¥–µ–ª–∞:**  
- –ü–æ–Ω–∏–º–∞–µ—à—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—É S3.  
- –£–º–µ–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å boto3 –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.  
- –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ S3 —Å Airflow –∏ DWH.
