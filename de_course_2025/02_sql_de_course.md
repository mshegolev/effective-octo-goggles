# Data Engineering ‚Äî –†–∞–∑–¥–µ–ª 2. SQL

**–ê–≤—Ç–æ—Ä:** –©–µ–≥–æ–ª–µ–≤ –ú–∏—Ö–∞–∏–ª  
**–ö—É—Ä—Å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, 2025**

---

## üìò –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–≤–≤–µ–¥–µ–Ω–∏–µ-–≤-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
2. [–û—Å–Ω–æ–≤—ã SQL](#–æ—Å–Ω–æ–≤—ã-sql)
3. [–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#–æ–∫–æ–Ω–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
4. [–ò–Ω–¥–µ–∫—Å—ã, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ MPP](#–∏–Ω–¥–µ–∫—Å—ã-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-–∏-mpp)
5. [–ü—Ä–∞–∫—Ç–∏–∫–∞ –∏ LeetCode –∑–∞–¥–∞—á–∏](#–ø—Ä–∞–∫—Ç–∏–∫–∞-–∏-leetcode-–∑–∞–¥–∞—á–∏)
6. [–ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –£—á–µ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫—É—Ä—Å—É](#–º–∏–Ω–∏–ø—Ä–æ–µ–∫—Ç-—É—á–µ–±–Ω–∞—è-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞-–ø–æ-–∫—É—Ä—Å—É)
7. [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏](#–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–≤–æ–ø—Ä–æ—Å—ã-–∏-gpt–ø–æ–¥—Å–∫–∞–∑–∫–∏)

---

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

üîπ –ü—Ä–æ—á–∏—Ç–∞—Ç—å: [–û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö ‚Äî Google Docs]  
üîπ –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–æ —Å—Ç–∞—Ç—å—ë–π: [–í–∏–¥—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö ‚Äî –•–∞–±—Ä](https://dzen.ru/a/ZumWFZ9ztwDXdcQc)

### üß† –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è
- –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –ë–î –∏ —Ç–∞–±–ª–∏—Ü—ã.
- –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á, –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á, —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.
- –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã (1NF, 2NF, 3NF).

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –û–±—ä—è—Å–Ω–∏, —á–µ–º —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –ë–î –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö.  
> –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏ –æ–±—ä—è—Å–Ω–∏, –ø–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ.

---

## –û—Å–Ω–æ–≤—ã SQL

### üß† –¢–µ–æ—Ä–∏—è

**–ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**  
`SELECT`, `FROM`, `WHERE`, `GROUP BY`, `ORDER BY`, `JOIN`, `UNION`, `CTE`, `SUBQUERY`.

### üíª –ü—Ä–∏–º–µ—Ä—ã

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    department_id INT,
    salary DECIMAL(10,2)
);

CREATE TABLE departments (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100)
);

-- –ü—Ä–æ—Å—Ç–æ–π SELECT
SELECT name, salary
FROM employees
WHERE salary > 50000
ORDER BY salary DESC;

-- JOIN –ø—Ä–∏–º–µ—Ä
SELECT e.name, d.name AS department, e.salary
FROM employees e
JOIN departments d ON e.department_id = d.id;
```

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –ü—Ä–∏–¥—É–º–∞–π –∑–∞–¥–∞—á—É –Ω–∞ `JOIN` —Å 3 —Ç–∞–±–ª–∏—Ü–∞–º–∏.  
> –û–±—ä—è—Å–Ω–∏, —á–µ–º `INNER JOIN` –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `LEFT JOIN`.

---

## –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### üß† –¢–µ–æ—Ä–∏—è

–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã **–ø–æ —á–∞—Å—Ç—è–º –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**, –Ω–µ –≥—Ä—É–ø–ø–∏—Ä—É—è —Å—Ç—Ä–æ–∫–∏.

–ö–ª—é—á–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: `OVER()`, `PARTITION BY`, `ORDER BY`, `RANK()`, `ROW_NUMBER()`, `LAG()`, `LEAD()`.

### üíª –ü—Ä–∏–º–µ—Ä—ã

```sql
-- Rank Scores (LeetCode)
SELECT score,
       DENSE_RANK() OVER (ORDER BY score DESC) AS rank
FROM Scores;

-- Second Highest Salary
SELECT MAX(salary) AS SecondHighestSalary
FROM Employee
WHERE salary < (SELECT MAX(salary) FROM Employee);

-- Product Sales Analysis III
SELECT product_id, year, quantity, price
FROM Sales
WHERE (product_id, year) IN (
  SELECT product_id, MAX(year)
  FROM Sales
  GROUP BY product_id
);
```

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –û–±—ä—è—Å–Ω–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –æ–∫–æ–Ω–Ω–æ–π –∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–µ–π.  
> –ü—Ä–∏–¥—É–º–∞–π –ø—Ä–∏–º–µ—Ä, –≥–¥–µ `LAG()` –ø–æ–º–æ–≥–∞–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã.

---

## –ò–Ω–¥–µ–∫—Å—ã, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ MPP

### üß† –¢–µ–æ—Ä–∏—è

üìò –ü—Ä–æ—á–∏—Ç–∞—Ç—å: *Index ‚Äî Roadmappers (—Ä–∞–∑–¥–µ–ª SQL)*  
üìò –ü—Ä–æ—á–∏—Ç–∞—Ç—å: [Greenplum ‚Äî Halltape Roadmap DE](https://halltape.github.io/HalltapeRoadmapDE/GREENPLUM/)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:**
- –ò–Ω–¥–µ–∫—Å—ã –∏ —Ç–∏–ø—ã (B-Tree, Hash).
- –ü–æ—á–µ–º—É –Ω–µ —Å—Ç–æ–∏—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –ø–æ–¥—Ä—è–¥.
- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `COUNT(*)` –∏ `COUNT(column)`.
- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `DROP`, `TRUNCATE`, `DELETE`.
- –ß—Ç–æ —Ç–∞–∫–æ–µ MPP –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Greenplum.

### üíª –ü—Ä–∏–º–µ—Ä

```sql
-- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞
CREATE INDEX idx_salary ON employees(salary);

-- –ê–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞
EXPLAIN ANALYZE
SELECT * FROM employees WHERE salary > 70000;
```

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –û–±—ä—è—Å–Ω–∏, –∫–æ–≥–¥–∞ –∏–Ω–¥–µ–∫—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–∏.  
> –ß—Ç–æ –±—ã—Å—Ç—Ä–µ–µ: `TRUNCATE` –∏–ª–∏ `DELETE`, –∏ –ø–æ—á–µ–º—É?

---

## –ü—Ä–∞–∫—Ç–∏–∫–∞ –∏ LeetCode –∑–∞–¥–∞—á–∏

1. [Rank Scores ‚Äî LeetCode](https://leetcode.com/problems/rank-scores/)  
2. [Second Highest Salary ‚Äî LeetCode](https://leetcode.com/problems/second-highest-salary/)  
3. [Department Highest Salary ‚Äî LeetCode](https://leetcode.com/problems/department-highest-salary/)  
4. [Product Sales Analysis III ‚Äî LeetCode](https://leetcode.com/problems/product-sales-analysis-iii/)  
5. [Department Top Three Salaries ‚Äî LeetCode](https://leetcode.com/problems/department-top-three-salaries/)  
6. [Trips and Users ‚Äî LeetCode](https://leetcode.com/problems/trips-and-users/)

üí° *–°–æ–≤–µ—Ç:* —Ä–µ—à–∞–π –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏ ‚Äî —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ —Å –æ–∫–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

---

## –ú–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç: –£—á–µ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫—É—Ä—Å—É

### üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å SQL-–æ—Ç—á—ë—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Stepik.

### üìã –ó–∞–¥–∞—á–∏
1. –°–æ–±–µ—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã: `students`, `lessons`, `submissions`.  
2. –ü–æ—Å—á–∏—Ç–∞–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –∫–∞–∂–¥—ã–º —Å—Ç—É–¥–µ–Ω—Ç–æ–º.  
3. –ù–∞–π–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ —É—Ä–æ–∫.  
4. –û–ø—Ä–µ–¥–µ–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ª—É—á—à–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å (TOP-3 –ø–æ —Ä–µ—à—ë–Ω–Ω—ã–º –∑–∞–¥–∞—á–∞–º).

### üíª –ü—Ä–∏–º–µ—Ä SQL-–∑–∞–ø—Ä–æ—Å–∞

```sql
WITH solved_tasks AS (
    SELECT student_id, COUNT(*) AS solved
    FROM submissions
    WHERE status = 'correct'
    GROUP BY student_id
)
SELECT s.name, st.solved
FROM students s
JOIN solved_tasks st ON s.id = st.student_id
ORDER BY st.solved DESC
LIMIT 3;
```

### üí° GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏
> –î–æ–±–∞–≤—å –≤ –æ—Ç—á—ë—Ç —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É –ø–æ —É—Ä–æ–∫—É.  
> –ö–∞–∫ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Å –æ–∫–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –≤–º–µ—Å—Ç–æ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤?

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ GPT-–ø–æ–¥—Å–∫–∞–∑–∫–∏

1. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è `INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`?  
2. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `UNION ALL` –∏ —á–µ–º –æ–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `UNION`?  
3. –ß–µ–º –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏—Ö?  
4. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `CTE` –∏ –∑–∞—á–µ–º –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?  
5. –ß—Ç–æ –±—ã—Å—Ç—Ä–µ–µ ‚Äî `COUNT(*)` –∏–ª–∏ `COUNT(column)`?  
6. –ü–æ—á–µ–º—É –Ω–µ —Å—Ç–æ–∏—Ç –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã?  
7. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Greenplum –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω MPP?

üí° *–°–æ–≤–µ—Ç:* –µ—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ, —Å–ø—Ä–æ—Å–∏ GPT:
> ¬´–û–±—ä—è—Å–Ω–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ... (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–∫–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)¬ª  
> ¬´–ü—Ä–∏–¥—É–º–∞–π SQL-–∑–∞–¥–∞—á—É –Ω–∞ —Ç–µ–º—É ... (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–¥–µ–∫—Å—ã –∏–ª–∏ CTE)¬ª

---

‚úÖ **–ò—Ç–æ–≥ —Ä–∞–∑–¥–µ–ª–∞:**
- –¢—ã –æ—Å–≤–æ–∏–ª –æ—Å–Ω–æ–≤—ã SQL –∏ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.  
- –£–º–µ–µ—à—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã.  
- –ü–æ–Ω–∏–º–∞–µ—à—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç MPP-—Å–∏—Å—Ç–µ–º—ã (Greenplum).  
- –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é DWH.
